<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">

<head>
</head>

<body>
    <script>
        // const cmsUrl = "https://unk.cascadecms.com/";
        // const cmsAPI = "e540eb9d-c641-415b-aa1f-6671982c08dd";
    </script>
    <script src="../cascade-restapi.js"></script>
    <script>
        search({
            searchInformation: {
                searchTerms: "UniversLT",
                searchTypes: ["Files"]
            }
        }).then(function (result) {
            console.log(result);
            result.apiReturn.matches.forEach(function (s) {
                // if (s.path.path.includes("training/test1")) {
                console.log(s);
                // if (s.type == "file") {
                //     checkCSS(s);
                // } else if (s.type == "page") {
                //     checkPage(s);
                // };
                // }
            });
        }).catch(function (error) {
            console.log(error);
        });

        function checkPage(page) {
            readAsset({
                type: page.type,
                id: page.id,
            }).then(function (result) {
                console.log(result);
                var structuredData = result.apiReturn.asset.page.structuredData.structuredDataNodes;
                structuredData.forEach(function (node) {
                    nodeCheck(node);
                });
                editAsset({
                    asset: result.apiReturn,
                }).then(function (result) {
                    console.log(result);
                }).catch(function (error) {
                    console.log(error);
                });
            }).catch(function (error) {
                console.log(error);
            });
        }

        function nodeCheck(node) {
            // console.log(node)
            if (node.type == "group") {
                node.structuredDataNodes.forEach(function (node2) {
                    nodeCheck(node2);
                });
            } else if (node.type == "text" && node.text) {
                // console.log(node.text);
                node.text = node.text.replace('"UniversLTW01-57Condense_723821",arial,sans-serif;', "'Roboto Condensed', sans-serif;")
                    .replace("'UniversLTW01-67BoldCn',arial,sans-serif;", "'Roboto', sans-serif; font-weight: 700;")
                    .replace('"UniversLTW01-67BoldCn",arial,sans-serif;', "'Roboto', sans-serif; font-weight: 700;")
                    .replace('"Univers LT W01_65 Bold",arial,sans-serif;', "'Roboto', sans-serif; font-weight: 700;")
                    .replace("'Univers LT W01_55 Roman', Arial, sans-serif;", "'Roboto', sans-serif;");
            }
        }

        function checkCSS(file) {
            readAsset({
                type: file.type,
                id: file.id,
            }).then(function (result) {
                console.log(result);
                // delete result.apiReturn.asset.file.data;
                result.apiReturn.asset.file.text = result.apiReturn.asset.file.text.replace('"UniversLTW01-57Condense_723821",arial,sans-serif;', "'Roboto Condensed', sans-serif;")
                    .replace("'UniversLTW01-67BoldCn',arial,sans-serif;", "'Roboto', sans-serif; font-weight: 700;")
                    .replace('"UniversLTW01-67BoldCn",arial,sans-serif;', "'Roboto', sans-serif; font-weight: 700;")
                    .replace('"Univers LT W01_65 Bold",arial,sans-serif;', "'Roboto', sans-serif; font-weight: 700;")
                    .replace("'Univers LT W01_55 Roman', Arial, sans-serif;", "'Roboto', sans-serif;");
                editAsset({
                    asset: result.apiReturn,
                }).then(function (result) {
                    console.log(result);
                }).catch(function (error) {
                    console.log(error);
                });
            }).catch(function (error) {
                console.log(error);
            });
        }
    </script>
</body>

</html>